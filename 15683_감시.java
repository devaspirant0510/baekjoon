/*============================================================================
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@$ .@@@@@@@@@@@@@@@@@@@@@@@@@@**@@@@@@@@@@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@*!@@@@@@@@@@@@@@@
 @@@@@@@@@@  .@@=.      ~: .@@@@@@@@@@@@@@@@@@@@@@@@@! !@@@@@@@@@@@@@@@
 @@@@@@@@@:    ,           *@@@@@@@@@@@@@@@@@@@@@@#@@! ,@!:@@@@@@@@@@@@
 @@@@@@@@@= .~              ~@@@@@@@@@@@@@@@@@@@@#  @  .*  !**=@@@@@@@@
 @@@@@@@@@@~       *,-!      = :@@@@@@@@@@@@@@@@@=  ! *,.  !   ;@@@@@@@
 @@@@@@@@@@@$.         .    ~    @@@@@@@@@@@@@@@@@ ; -:    ,    =@@@@@@
 @@@@@@@@@@@=    .      :   ~     @@@@@@@@@@@@@@@@, ;     !,    *@@@@@@
 @@@@@@@@@@@;   ,           ~    :#@@@@@@@@@@@@!   -!.    ~  -;.@@@@@
 @@@@@@@@@@@,   *  *     ;  ~   .**@@@@@@@@@@@@# . ~  *. ~   * .  ~@@@@
 @@@@@@@@@@@,   !  *-    :       ,!@@@@@@@@@@@@  ;  ! *  :   .     @@@@
 @@@@@@@@@@@,   *  **    :        *@@@@@@@@@@@-   ,  , :;     ,   ,@@@@
 @@@@@@@@@@@;   .        !   :    @@@@@@@@@@@!                ! . #@@@@
 @@@@@@@@@@@=              **     @@@@@@@@@@@   !             !!*,*@@@@
 @@@@@@@@@@@@    .      : .,. !  @@@@@@@@@@@*   !    .        !    !@@@
 @@@@@@@@@@@@     ,    .  !,*   @@@@@@@@@@@@.        *        *     @@@
 @@@@@@@@@@@@.      ~!-   .     @@@@@@@@@@@@                  *    ~@@@
 @@@@@@@@@@@@;                  @@@@@@@@@@@@   !;**   .       * -! @@@@
 @@@@@@@@@@@@!                  @@@@@@@@@  :       ..!        ! -!@@@@@
 @@@@@@@@@@@@~                  @@@@@@@@*   !   !   !         !  =#**@@
 @@@@@@@@@@@@:~~:-----~~~:~~~~~~#@@@@@@@!        .;,          ! !,  .@@
 @@@@@@@@@@@!:::::-            .@@@@@@@@=    ,                :!  ;*=@@
 @@@@@@@@@@@:::::.             .@@@@@@@@@!     !.    -;        ;    =@@
 @@@@@@@@@@:::::.        !: -  ;@@@@@@#@@@#-      *.            ! !@@@@
 @@@@@@@@@:::::    .    .*:-   =@@@@@@@@*@@@!     : .~~.         *@@@@@
 @@@@@@@@:::::,    ;.    !: :  ;@@@@@@@#@@@#@#-   .,,-~ .  -      ;==@@
 @@@@@@@;::::.      !  ! !; :! ~@@@@@@@@@$=@@@@@*~..,  .,   ~       -!!
 @@@@@@;::::;         .: ! :: .@@@@@@@@@*@@@@@@@@@...  ..     ;
 @@@@;::::;;;         ;: * :  =@@@@@@@@@@@@@@@@@@@~,,.,-.      :,    -:
 @#::::;;;;;;-         ;  :!  @@@@@@@@@@@@@@@@@@@@* ,..,         ,  ,~*
 @:=!;;;;;;;;*            :  =@@@@@@@@@@@@@@@@@@@@@              ~,*~=@
 *@@@@@!;;;;;;.         ;;  ~@@@@@@@@@@@@@@@@@@@@@@$              @@@@@
 @@@@@@@@@##@@@            ,@@@@@@@@@@@@@@@@@@@@@@@@=             @@@@@
 @@@@@@@@@@@@@@@! .       !@@@@@@@@@@@@@@@@@@@@@@@@@@=  !,       !@@@@@
 @@@@@@@@@@@@@@@@#.,   -*@.@@@@@@@@@@@@@@@@@@@@@@@@@@*    @$     =@@@@@
 @@@@@@@@@@@@@@@@:@@@@@@=@@@@@@@@@@@@@@@@@@@@@@@@@@*    @$     @@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*    @*    ;@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;    @:    @@@@@@@
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.   !@.   ~@@@@@@@
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ† ë°±ì¤€ ì˜¨ë¼ì¸ ì €ì§€ (Baekjoon Online Judge)
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ“Œ ë¬¸ì œ ë²ˆí˜¸  : 15683
 * ğŸ“Œ ë¬¸ì œ ì œëª©  : ê°ì‹œ
 * ğŸ”— ë¬¸ì œ ë§í¬  : https://www.acmicpc.net/problem/15683
 * âœï¸ ì‘ì„±ì     : seungho0510
 * ğŸ“… ì‘ì„± ë‚ ì§œ  : 2025-05-07
 ============================================================================*/

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.StringTokenizer;

public class Main {
    private static int n, m;

    // 1ë²ˆ í•œë°©í–¥
    // 2ë²ˆ ì–‘ë°©í–¥
    // 3ë²ˆ ì§ê°ë°©í–¥
    // 4ë²ˆ ì„¸ë°©í–¥
    // 5ë²ˆ ë„¤ë°©í–¥
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        String[] line = br.readLine().split(" ");
        n = Integer.parseInt(line[0]);
        m = Integer.parseInt(line[1]);
        int[][] arr = new int[n][m];
        boolean[][] cached = new boolean[n][m];
        StringTokenizer st;
        List<int[]> q = new ArrayList<>();
        // 5ë²ˆì‹œì‹œí‹°ë¹„ëŠ” ë°©í–¥ì „í™˜ì´ ì—†ê¸°ë–„ë¬¸ì— ì‚¬ì „ì— ì²˜ë¦¬
        List<int[]> q5 = new ArrayList<>();
        for (int i = 0; i < n; i++) {
            st = new StringTokenizer(br.readLine());
            for (int j = 0; j < m; j++) {
                int value = Integer.parseInt(st.nextToken());

                if (1 <= value && value < 5) {
                    // cctv ìˆëŠ”ê³³ì€ ì´ë¯¸ ë¹„ì¶°ì§€ëŠ”ê³³
                    cached[i][j] = true;
                    //0 ìœ„ 1 ìš° 2 í•˜ 3 ì¢Œ
                    q.add(new int[]{i, j, value, 0});

                }
                if(value==5){
                    q5.add(new int[]{i,j,value,0});
                }
                // ë²½ì€ ì‹œì‹œí‹°ë¹„ê°€ ê°ì‹œìì²´ë¥¼ ëª»í•˜ë‹ˆ ë°©ë¬¸ì²˜ë¦¬
                if (value == 6) {
                   cached[i][j] = true;
                }
                arr[i][j] = value;
            }
        }
        List<Integer> cctvRange = new ArrayList<>();
        for (int i = 0; i < q.size(); i++) {
            // cctv 5ë²ˆ ìœ í˜•ì€ í•­ìƒ ê³ ì •ì´ì–´ì„œ ë‚˜ë¨¸ì§€ëŠ”
            int[] getCctvInfo = q.get(i);
            if (getCctvInfo[2] != 5) {
                if (getCctvInfo[2] == 2) {
                    // 2ë²ˆ cctv ëŠ” ë°©í–¥ì „í™˜ì´ 2ê°œ
                    cctvRange.add(2);
                } else {
                    // ë‚˜ë¨¸ì§€ëŠ” ë°©í–¥ì „í™˜ 4ê°œ
                    cctvRange.add(4);
                }
            }
        }
        for (int i = 0; i <q5.size() ; i++) {
            int[] getCctvInfo = q5.get(i);
            for (int x = getCctvInfo[1]; x < m; x++) {
                // ë²½ë§Œë‚˜ë©´ ë°©ë¬¸ì²˜ë¦¬ ë
                if (arr[getCctvInfo[0]][x] == 6) {
                    break;
                }
                cached[getCctvInfo[0]][x] = true;
            }
            for (int x = getCctvInfo[1]; x >= 0; x--) {
                // ë²½ë§Œë‚˜ë©´ ë°©ë¬¸ì²˜ë¦¬ ë
                if (arr[getCctvInfo[0]][x] == 6) {
                    break;
                }
                cached[getCctvInfo[0]][x] = true;
            }
            for (int y = getCctvInfo[0]; y < n; y++) {
                // ë²½ë§Œë‚˜ë©´ ë°©ë¬¸ì²˜ë¦¬ ë
                if (arr[y][getCctvInfo[1]] == 6) {
                    break;
                }
                cached[y][getCctvInfo[1]] = true;
            }
            for (int y = getCctvInfo[0]; y >= 0; y--) {
                // ë²½ë§Œë‚˜ë©´ ë°©ë¬¸ì²˜ë¦¬ ë
                if (arr[y][getCctvInfo[1]] == 6) {
                    break;
                }
                cached[y][getCctvInfo[1]] = true;
            }

        }

        List<int[]> status = new ArrayList<>();

        getAllCctv(0, new int[cctvRange.size()], cctvRange.size(), cctvRange, status);



        int maxViewCount = n*m+1;
        for (int i = 0; i < status.size(); i++) {
            boolean[][] backupCache = copy2DArray(cached);
            for (int j = 0; j < q.size(); j++) {
                int[] cctvInfo = q.get(j);
                int cctv = cctvInfo[2];
                int[] cctvDir = status.get(i);
                // 5ë²ˆ ì‹œì‹œí‹°ë¹„ ì´ë¯¸ í–ˆìœ¼ë‹ˆê¹Œ íŒ¨ìŠ¤
                if (cctv != 5) {
                    // ì§ì„  cctv

                        viewCctv(cctv, cctvInfo[0], cctvInfo[1], cctvDir[j], backupCache, arr);


                }
            }
//            for(int e:status.get(i)){
//                System.out.print(e+",");
//            }
//            System.out.println();
//            showCache(backupCache);
//            System.out.println();
            int cc = getAbleViewCount(backupCache);
            if(maxViewCount>cc){
                maxViewCount = cc;
            }


        }
        System.out.println(maxViewCount);
    }

    public static int getAbleViewCount(boolean[][] cached) {
        int c = 0;
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                if (!cached[i][j]) {
                    c++;
                }
            }
        }
        return c;
    }

    public static void showCache(boolean[][] cached) {
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                System.out.print(cached[i][j]?"ğŸŸ¦":"â¬œï¸" + "");
            }
            System.out.println();
        }
        System.out.println();
    }

    public static void viewTop(int y, int x, int[][] arr, boolean[][] cached) {
        for (int i = y; i >= 0; i--) {
            if (arr[i][x] == 6) {
                break;
            }
            cached[i][x] = true;
        }

    }

    public static void viewRight(int y, int x, int[][] arr, boolean[][] cached) {
        for (int i = x; i < m; i++) {
            if (arr[y][i] == 6) {
                break;
            }
            cached[y][i] = true;
        }

    }

    public static void viewBot(int y, int x, int[][] arr, boolean[][] cached) {
        for (int i = y; i < n; i++) {
            if (arr[i][x] == 6) {
                break;
            }
            cached[i][x] = true;
        }
    }

    public static void viewLeft(int y, int x, int[][] arr, boolean[][] cached) {
        for (int i = x; i >= 0; i--) {
            if (arr[y][i] == 6) {
                break;
            }
            cached[y][i] = true;
        }
    }

    public static void viewCctv(int cctvType, int y, int x, int dir, boolean[][] cached, int[][] arr) {
        switch (cctvType) {
            // ì¼ì ì”¨ì”¨í‹°ë¹„
            case 1: {
                /// ìœ„
                if (dir == 0) {
                    viewTop(y, x, arr, cached);
                }
                // ìš°
                else if (dir == 1) {
                    viewRight(y, x, arr, cached);
                }
                // í•˜
                else if (dir == 2) {
                    viewBot(y, x, arr, cached);
                }
                // ì¢Œ
                else {
                    viewLeft(y, x, arr, cached);
                }
                break;
            }
            // ì–‘ë°©í–¥ ì¼ì ì”¨ì‹œí‹°ë¹„
            case 2:{
                if(dir==0){
                    viewTop(y, x, arr, cached);
                    viewBot(y, x, arr, cached);
                }
                else{
                    viewRight(y, x, arr, cached);
                    viewLeft(y, x, arr, cached);
                }
                break;
            }
            // ê¸°ì—­ì ì‹œì‹œí‹°ë¹„
            case 3:{
                if(dir==0){
                    viewTop(y, x, arr, cached);
                    viewRight(y, x, arr, cached);
                }
                else if(dir==1){
                    viewRight(y, x, arr, cached);
                    viewBot(y, x, arr, cached);
                }
                else if(dir==2){
                    viewBot(y, x, arr, cached);
                    viewLeft(y, x, arr, cached);
                }else{
                    viewLeft(y, x, arr, cached);
                    viewTop(y, x, arr, cached);
                }
                break;
            }
            // 3ë°©í–¥ ì”¨ì‹œí‹°ë¹„
            case 4:{
                if(dir==0){
                    // ã…
                    viewTop(y, x, arr, cached);
                    viewRight(y, x, arr, cached);
                    viewBot(y, x, arr, cached);
                }
                else if(dir==1){
                    // ã…œ
                    viewRight(y, x, arr, cached);
                    viewBot(y, x, arr, cached);
                    viewLeft(y, x, arr, cached);
                }
                else if(dir==2){
                    // ã…“
                    viewBot(y, x, arr, cached);
                    viewLeft(y, x, arr, cached);
                    viewTop(y, x, arr, cached);
                }else{
                    // ã…—
                    viewLeft(y, x, arr, cached);
                    viewTop(y, x, arr, cached);
                    viewRight(y, x, arr, cached);
                }
                break;
            }

        }

    }

    public static boolean[][] copy2DArray(boolean[][] src) {
        boolean[][] dest = new boolean[src.length][];
        for (int i = 0; i < src.length; i++) {
            dest[i] = src[i].clone(); // ì–•ì€ ë³µì‚¬ ë°©ì§€
        }
        return dest;
    }

    public static int[][] copy2DArray(int[][] src) {
        int[][] dest = new int[src.length][];
        for (int i = 0; i < src.length; i++) {
            dest[i] = src[i].clone(); // ì–•ì€ ë³µì‚¬ ë°©ì§€
        }
        return dest;
    }

    private static void getAllCctv(int depth, int[] cctvDir, int n, List<Integer> cctvRange, List<int[]> status) {
        if (depth == n) {
            status.add(Arrays.copyOf(cctvDir, cctvDir.length));
            return;
        }
        for (int dir = 0; dir < cctvRange.get(depth); dir++) {
            cctvDir[depth] = dir;
            getAllCctv(depth + 1, cctvDir, n, cctvRange, status);
        }
    }
}

